<!DOCTYPE html>
<html lang="en">
<head>
    <title>Groundwater</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Oregon Water Atlas: Groundwater" />
    <meta property="og:url" content="http://rawgit.com/cartobaldrica/water_atlas/master/groundwater_index.html" />
    <meta property="og:description" content="Explore Oregon's groundwater." />
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="css/groundwater_style.css">
    <link rel="stylesheet" href="css/control-minimap2.css" />
    <link rel="stylesheet" href="css/ekko-lightbox.css"/>        
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Inconsolata" />

	<link rel="shortcut icon" href="img/oregon.ico" type="image/x-icon">
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">


    <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/leaflet.ajax.min.js"></script>
    <script src="js/storymap.js"></script>
	<script src="js/ekko-lightbox.js"></script>
	<script src="js/control-minimap.js" type="text/javascript"></script>
	
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top navbar-toggleable-md" role="navigation">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header" style="left:10px; position: fixed;">
            <a class="navbar-brand" href="https://cartobaldrica.github.io/">Home</a>
            <a class="navbar-brand" href="#">Groundwater</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=recharge]').offset().top - $(window).scrollTop() - 10);">Recharge</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=recharge2]').offset().top - $(window).scrollTop() - 10);">Sand and Gravel</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=recharge3]').offset().top - $(window).scrollTop() - 10);">Volcanic</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=recharge4]').offset().top - $(window).scrollTop() - 10);">Other</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=irrigation_aquifers]').offset().top - $(window).scrollTop() - 10);">Irrigation</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=county_use]').offset().top - $(window).scrollTop() - 10);">Groundwater Use</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=conservation_critical]').offset().top - $(window).scrollTop() - 10);">Conservation</a>
                </li>
                <li>
                    <a href="javascript:window.scrollBy(0, $('section[data-scene=conservation_management]').offset().top - $(window).scrollTop() - 10);">Management</a>
                </li>
                <li>
            		<a  data-toggle="modal" data-target="#info-modal">About</a>
                </li>
                <li>
                 <div class="dropdown">
  					<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    					Share
  					</button>
  					<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    					<a class="dropdown-item" target="_blank" href="https://facebook.com/sharer.php?u=http://rawgit.com/cartobaldrica/water_atlas/master/infrastructure_index.html">Facebook</a><br/>
   						<a class="dropdown-item" target="_blank" href="https://twitter.com/home?status=Oregon's%20Groundwater%0Ahttp%3A//rawgit.com/cartobaldrica/water_atlas/master/infrastructure_index.html">Twitter</a><br/>
    					<a class="dropdown-item" target="_blank" href="https://github.com/cartobaldrica/water_atlas">Github</a>
  					</div>
				</div>
				</li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
     <!-- /.container -->
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 main">
        
             <section data-scene="overview">
				 	<div class= "overview-background-img background-fullscreen-setting text-responsive text-shadow: black 0.2em 0.2em 0.3em;"><h4 class="text-center" style="color: white">Groundwater</h4><h4 class ="text-center" style="font-size:20px; margin-top:0px; color: #ffffff; text-shadow: black 0.2em 0.2em 0.3em; margin-left: 25%; margin-right:25%; text-align: justify;">Groundwater is the most difficult aspect of Oregon's water to measure. It primarily exists in the spaces between soil and rock particles underground. Groundwater is particularly important in Eastern and Central Oregon, where surface water supplies are limited. </h4>
                	<br/><br/>
                	<p class ="text-center" style="font-size:14px; margin-top:0px; color: #ffffff; text-shadow: black 0.2em 0.2em 0.3em; margin-left: 30%; margin-right:30%; ">Created by Gareth Baldrica-Franklin, Institute for Water and Watersheds, Oregon State University</p></div>
                	<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>            
            </section>
            
             <section data-scene="recharge">
                <h3>Aquifers and Recharge</h3>
 				<p>Groundwater exists in aquifers, which vary based on rock type. Oregon has three principal aquifer rock types. Different aquifer types have variable productivity and accessibility.</p>
				<p>Groundwater recharge is a measurement of how quickly aquifers are replenished with new water. Recharge mainly depends on precipitation, elevation, permeability and plant cover. Greater recharge generally means more sustainable groundwater.</p>				
				<div class="leg"><p style="text-align: left; font-weight: bold;">Recharge(mm/yr)</p><p style="text-align: left;">0 &nbsp&nbsp&nbsp 20 &nbsp&nbsp&nbsp&nbsp100 &nbsp&nbsp&nbsp&nbsp500</p><p style="text-align: left; margin-top: -25px; margin-left:246px; margin-bottom:3px; font-weight: bold;">Aquifer Type</p><i style="background: #e6ecff; fillOpacity: .7; color:#e6ecff; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #99b3ff; fillOpacity: .7; color:#99b3ff; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7; "></i><i style="background: #4d79ff; fillOpacity: .7; color:#4d79ff; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #0033cc; fillOpacity: .7; color:#0033cc; margin-right: 0px;  width: 60px; weight: 1; opacity: 0.7; "></i><p style="text-align: left; ">&nbspSand/Gravel</p><i style="background: #ecf9ec; fillOpacity: .7; color:#ecf9ec; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #b3e6b3; fillOpacity: .7; color:#b3e6b3; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7;"></i><i style="background: #66cc66; fillOpacity: .7; color:#66cc66; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #267326; fillOpacity: .7; color:#267326; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><p style="text-align: left;">&nbspVolcanic</p><i style="background: #ebebe0; fillOpacity: .7; color:#ebebe0; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #ccccb3; fillOpacity: .7; color:#ccccb3; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7;"></i><i style="background: #a3a375; fillOpacity: .7; color:#a3a375; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #5c5c3d; fillOpacity: .7; color:#5c5c3d; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><p style="text-align: left;">&nbspOther</p>
				<p>Hover over map for details</p></div>
			</section>     
			
			<section data-scene="recharge2">
				<h3>Sand and Gravel</h3>
				<p style = "color: #4d79ff; display:inline">Sand and gravel</p><p style ="display:inline"> aquifers exist in lowlands and river valleys. They are shallow, accesible, and comprise the most productive aquifers in the state.</p>
				<br/><br/>
				<p>Sand and gravel aquifers are formed by erosion or faulting. They typically yield 20-2,000 gallons per minute to wells.</p>
				<br/>
				<div class="leg"><p style="text-align: left; font-weight: bold;">Recharge(mm/yr)</p><p style="text-align: left;">0 &nbsp&nbsp&nbsp 20 &nbsp&nbsp&nbsp&nbsp100 &nbsp&nbsp&nbsp&nbsp500</p><i style="background: #e6ecff; fillOpacity: .7; color:#e6ecff; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #99b3ff; fillOpacity: .7; color:#99b3ff; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7; "></i><i style="background: #4d79ff; fillOpacity: .7; color:#4d79ff; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #0033cc; fillOpacity: .7; color:#0033cc; margin-right: 0px;  width: 60px; weight: 1; opacity: 0.7; "></i></div>
			</section>    
			
			<section data-scene="recharge3">
				<h3>Volcanic</h3>
				<p style = "color: #66cc66; display:inline">Volcanic</p><p style ="display:inline"> aquifers cover eastern and central Oregon. Basalt flows form the most productive volcanic aquifers, while other volcanic formations are more variable.</p>
				<br/><br/>
				<p>Many volcanic aquifers exist in remote areas. As a result, there is a lack of information about the depth of these aquifers.</p>
				<br/>
				<div class="leg"><p style="text-align: left; font-weight: bold;">Recharge(mm/yr)</p><p style="text-align: left;">0 &nbsp&nbsp&nbsp 20 &nbsp&nbsp&nbsp&nbsp100 &nbsp&nbsp&nbsp&nbsp500</p><i style="background: #ecf9ec; fillOpacity: .7; color:#ecf9ec; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #b3e6b3; fillOpacity: .7; color:#b3e6b3; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7;"></i><i style="background: #66cc66; fillOpacity: .7; color:#66cc66; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #267326; fillOpacity: .7; color:#267326; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i></div>
			</section> 
			
			<section data-scene="recharge4">
				<h3>Other</h3>
				<p style = "color: #a3a375; display:inline">Other</p><p style ="display:inline"> aquifers in Oregon consist of various rock types. Many of these rock types are older than previously discussed aquifers, and they typically have marine origin.</p> 
				<br/><br/>
				<p>These aquifers, on average, yield 1 to 100 gallons a minute to wells, making them among the least productive aquifers in the state.</p>
				<br/>
				<div class="leg"><p style="text-align: left; font-weight: bold;">Recharge(mm/yr)</p><p style="text-align: left;">0 &nbsp&nbsp&nbsp 20 &nbsp&nbsp&nbsp&nbsp100 &nbsp&nbsp&nbsp&nbsp500</p><i style="background: #ebebe0; fillOpacity: .7; color:#ebebe0; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #ccccb3; fillOpacity: .7; color:#ccccb3; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7;"></i><i style="background: #a3a375; fillOpacity: .7; color:#a3a375; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #5c5c3d; fillOpacity: .7; color:#5c5c3d; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i></div>
			</section> 
			
			<section  data-scene="irrigation_aquifers">
                <h3>Irrigation and Aquifers</h3>
				<p>Almost 90% of Oregon's groundwater extraction is used for irrigation. Each point on the map represents a claimed irrigation water right, and is colored based on the underlying aquifer type.</p>
            	<p>With so much reliance on specific aquifers, especially in the drought-prone regions of Eastern Oregon, groundwater sustainability becomes paramount.</p> 
            	<div class="leg"><p style ="font-weight: bold;">Groundwater Irrigation Rights</p><p>Aquifer Type</p><i style="background: #ccccb3; opacity: 0.8"></i><p>Sand & Gravel</p><i style="background: #8cd98c; opacity: 0.8"></i><p>Volcanic</p><i style="background: #4d79ff; opacity: 0.8"></i><p>Other</p></div>
    		</section>
    		
    		<section  data-scene="county_use">
                <h3>County Groundwater Use</h3>
           	    <p>The USGS National Water Use Information Program compiles water use data by county every five years. Water use data is categorized by both its purpose (irrigation, domestic, mining, etc.) and its type (surface or ground, fresh or saline). Data are collected in terms of millions of gallons extracted per day.</p>
            	<div class="leg"><p style ="font-weight: bold;">2010 Total Groundwater <br/> Use in Mgal/day</p><br/><br/><i style="background: #f8000c; opacity: 0.8"></i><p>300+</p><i style="background: #ff6343; opacity: 0.8"></i><p>200 - 300</p><i style="background: #ffa458; opacity: 0.8"></i><p>100 - 200</p><i style="background: #ffd58d; opacity: 0.8"></i><p>25 - 100</p><i style="background: #feffcd; opacity: 0.8"></i><p>0 - 25</p>
            	<p>Hover over counties for details</p></div>
            </section>      
             
            <section data-scene="conservation_critical">
                <h3>Groundwater Conservation</h3>
          	    <p style = "color: #f8000c; display: inline">Critical Groundwater Areas</p><p style = "display: inline"> are created in areas where it is estimated that extraction has resulted in declining groundwater levels. Critical groundwater areas face restrictions on withdrawal rates and limits on the ability to obtain new groundwater permits. The program began in 1965.</p>
                <br/><br/>
                <p style = "display: inline">The </p><p style = "color: #ffa458; display: inline">Groundwater Limited Area</p><p style = "display: inline"> program is designed to conserve groundwater in areas where groundwater levels are at risk of falling. Restrictions in groundwater limited areas are often not as severe as they are in critical groundwater areas.</p>
            	<br/><br/>
            	<div class="leg"><i style="background: #f8000c; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">GW Critical Area</b></p><i style="background: #ffa458; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">GW Limited Area</b></p>
            	<p>Hover over areas for details</p></div>
            </section>
            
            <section data-scene="conservation_management">
                <h3>Groundwater Management</h3>
				<p>Groundwater Management Areas (GWMA) are declared by the Oregon Department of Environmental Quality in areas that have increased contaminant levels. The three designated GWMAs in Oregon were all created in response to increased nitrate levels. Local management committees in affected areas work with state agencies to produce action plans for reducing contaminant levels.</p>
            	<div class="leg"><i style="background: #ffa458; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">GW Management Area</b></p>
            	<p>Hover over areas for details</p>
            	</div>
            </section>
   
            <section data-scene="end">
				 	<div class= "end-background-img background-fullscreen-setting text-responsive"><br>
            </section>
        	<i class="animated zoomIn infinite glyphicon glyphicon-arrow-up arrow-up"></i>
        	<i class="animated zoomIn infinite glyphicon glyphicon-arrow-down arrow-down"></i>

        </div>
        <div id="map" class="col-sm-6 col-md-8 sidebar"></div>
    </div>
     <i class="fa fa-info-circle social" style="right:70px;" data-toggle="modal" data-target="#info-modal"></i>
    
	<a class="fa fa-facebook-square social2" style="right:55px;" href="https://facebook.com/sharer.php?u=http://rawgit.com/cartobaldrica/water_atlas/master/infrastructure_index.html" target="_blank"></a>
        
    <a class="fa fa-twitter-square social3" style="right:40px;" href="https://twitter.com/home?status=Oregon's%20Groundwater%0Ahttp%3A//rawgit.com/cartobaldrica/water_atlas/master/infrastructure_index.html" target="_blank"></a>
	
	<a class="fa fa-github-square social3" style="right:25px;" href="https://github.com/cartobaldrica/water_atlas" target="_blank"></a>
	

    
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title" style="color:black;">About</h2>
                </div>
                <div class="modal-body">
                    <p2>Cover Photo by Angel Schatz - Retrieved from Flickr</p2><br>
                    <p2>End Photo by Another Believer - Retrieved from Wikimedia Commons</p2><br>
                    <p2>Basemap by CARTO</p><br/>
                    <p2 style="font-size:20px">Geographic Data</p2><br>
                    <p2>Groundwater Recharge: <a href = "https://catalog.data.gov/dataset/a-digital-hydrologic-network-supporting-nawqa-mrb-sparrow-modeling-mrb-e2rf1ws" target="_blank">MRB-SPARROW Model</a> and <a href = "https://catalog.data.gov/dataset/attributes-for-mrb-e2rf1-catchments-by-major-river-basins-in-the-conterminous-united-state-20024c1a4" target="_blank">Recharge Attributes</a></p2><br>
                	<p2>Aquifers: <a href = "https://water.usgs.gov/GIS/metadata/usgswrd/XML/aquifers_us.xml#stdorder" target="_blank">USGS</a></p2><br>
                	<p2>Groundwater Irrigation: <a href = "https://www.oregon.gov/owrd/Pages/maps/index.aspx" target="_blank">Oregon Water Resources Department</a></p2><br>
                	<p2>Water Use by County: <a href = "https://waterdata.usgs.gov/or/nwis/water_use?format=html_table&rdb_compression=file&wu_area=County&wu_year=2010&wu_county=ALL&wu_county_nms=--ALL%2BCounties--" target="_blank">USGS National Water Information System</a></p2><br>
                	<p2>Groundwater Limited and Critical Areas: <a href = "https://www.oregon.gov/owrd/pages/gw/gw_critical_allocations.aspx" target="_blank">Oregon Water Resources Department</a></p2><br>
                	<p2>Groundwater Management Areas: <a href = "http://spatialdata.oregonexplorer.info/geoportal/catalog/search/resource/details.page?uuid=%7BAB957B8B-4F72-44B6-8FE9-02EB4F1DD6F5%7D" target="_blank">Oregon DEQ/Spatial Data Library</a></p2><br>
                	<p2 style="font-size:20px">Text Data</p2><br>
                	<p2>USGS National Groundwater Atlas</p2>
                	<p2>Oregon DEQ</p2>
                	<p2>Oregon Water Resources Department</p2>
                	<p2>The Oregonian</p2>
                </div>
                <div class="modal-footer">
                    <p2>Created with Leaflet and storymap.js</p>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="share-modal" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-body">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <a class="fa fa-facebook-square social2" style="font-size: 8em; display:inline;" href="https://facebook.com/sharer.php?u=http://rawgit.com/cartobaldrica/water_atlas/master/infrastructure_index.html" target="_blank"></a>
    				<a class="fa fa-twitter-square social3" style="font-size: 8em; display:inline;" href="https://twitter.com/home?status=Oregon's%20Groundwater%0Ahttp%3A//rawgit.com/cartobaldrica/water_atlas/master/infrastructure_index.html" target="_blank"></a>
					<a class="fa fa-github-square social3" style="font-size: 8em; display:inline;" href="https://github.com/cartobaldrica/water_atlas" target="_blank"></a>
					<br/>
                </div>
            </div>
        </div>
    </div>
    
</div>


<script type="text/javascript">

//conservation management        
    function consOpacity(string){
        if (string == "GWMA") {return 0.8}
        else {return 0}
    }
    	
     function consStyle(feature) {
        return {
            fillColor: '#ffa458',
            fillOpacity: consOpacity(feature.properties.Type),
            weight: 1.5,
            color: '#ffffff',
            opacity: consOpacity(feature.properties.Type),
        };
    }
//conservation critical areas    
    function critOpacity(string){
        if (string == "GWMA") {return 0}
        else {return 0.8}
    }
    
    function critColor(string){
        if (string == "GWCA") {return '#f8000c'}
        else {return '#ffa458'}
    }
    	
     function critStyle(feature) {
        return {
            fillColor: critColor(feature.properties.Type),
            fillOpacity: critOpacity(feature.properties.Type),
            weight: 1.5,
            color: '#ffffff',
            opacity: critOpacity(feature.properties.Type),
        };
    }
    	
    function highlightFeature(e) {
    	var layer = e.target;
    	layer.bringToFront();
    }
    
//counties1
    function setCountyColor(density){
        return density > 300 ? '#f8000c' :
        density > 200 ? '#ff6343':
        density > 100 ? '#ffa458':
        density > 25 ? '#ffd58d':
        '#feffcd';
    }
    
    function countyStyle(feature) {
        return {
           fillColor: setCountyColor(feature.properties.total), 
           fillOpacity: .8, 
           color: '#ffffff', 
           radius: 4, 
           opacity: .8, 
           weight: 1
        };
    }
    
    function highlightCounty(e) {
    	var layer = e.target;
    	
    	layer.setStyle({
        	fillOpacity: 1,
        	weight: 2
    	});
    	layer.bringToFront();
    }
    
    function resetCounty(e) {
    	var layer = e.target;
    	
    	layer.setStyle({
           	fillOpacity: 0.8,
        	weight: 1
    	});
    }
//counties2
    function countyStyle2(feature) {
        return {
           fillOpacity: 0, 
           color: '#ffffff', 
           opacity: 1, 
           weight: .5,
           clickable: false
        };
    }
//groundwater recharge
 	  function gwColor(string1, string2){
        if (string1 == 1 && string2 == 1) {return '#ebebe0'}
        else if (string1 == 1 && string2 == 2) {return '#ccccb3'}
        else if (string1 == 1 && string2 == 3) {return '#a3a375'}
        else if (string1 == 1 && string2 == 4) {return '#5c5c3d'}
        else if (string1 == 2 && string2 == 1) {return '#ecf9ec'}
        else if (string1 == 2 && string2 == 2) {return '#b3e6b3'}
        else if (string1 == 2 && string2 == 3) {return '#66cc66'}
        else if (string1 == 2 && string2 == 4) {return '#267326'}
        else if (string1 == 3 && string2 == 1) {return '#e6ecff'}
        else if (string1 == 3 && string2 == 2) {return '#99b3ff'}
        else if (string1 == 3 && string2 == 3) {return '#4d79ff'}
        else if (string1 == 3 && string2 == 4) {return '#0033cc'}
        else {return 1}
   	}
    function gwStyle(feature) {
        return {
           fillColor: gwColor(feature.properties.Z, feature.properties.recharge), 
           fillOpacity: .7, 
           color: gwColor(feature.properties.Z, feature.properties.recharge), 
           opacity: .7, 
           weight: 1
        };
    }
    function gwStyle2(feature) {
        return {
           color: gwColor(feature.properties.Z, feature.properties.recharge), 
        };
    }
    
    function highlightGroundwater(e) {
    	var layer = e.target;
    	
    	layer.setStyle({
        	color: '#ffffff',
        	fillOpacity: 1,
        	weight: 2
    	});
    	layer.bringToFront();
    }
    
    function resetGroundwater(e) {
    	var layer = e.target;
    	
    	layer.setStyle({
           	color: gwStyle2,
           	fillOpacity: 0.7,
        	weight: 1
    	});
    }
//sand and gravel
	function sandStyle(feature) {
        return {
           fillColor: gwColor(feature.properties.Z, feature.properties.recharge), 
           fillOpacity: sandOpacity(feature.properties.Z), 
           color: gwColor(feature.properties.Z, feature.properties.recharge), 
           opacity: sandOpacity(feature.properties.Z), 
           weight: 1
        };
    }
	
	function sandOpacity(density){
        if (density == 3) {return 0.7}
        else if (density == 2) {return 0}
        else {return 0}
   	}
    
//volcanic
function volStyle(feature) {
        return {
           fillColor: gwColor(feature.properties.Z, feature.properties.recharge), 
           fillOpacity: volOpacity(feature.properties.Z), 
           color: gwColor(feature.properties.Z, feature.properties.recharge), 
           opacity: volOpacity(feature.properties.Z), 
           weight: 1
        };
    }
	
	function volOpacity(density){
        if (density == 3) {return 0}
        else if (density == 2) {return 0.7}
        else {return 0}
   	}


//other
function otherStyle(feature) {
        return {
           fillColor: gwColor(feature.properties.Z, feature.properties.recharge), 
           fillOpacity: otherOpacity(feature.properties.Z), 
           color: gwColor(feature.properties.Z, feature.properties.recharge), 
           opacity: otherOpacity(feature.properties.Z), 
           weight: 1
        };
    }
	
	function otherOpacity(density){
        if (density == 3) {return 0}
        else if (density == 2) {return 0}
        else {return 0.7}
   	}


	var surface_style2 = {fillColor: '#b3d1ff', fillOpacity: 1, color: '#4d94ff', radius: 1, opacity: 1, weight: 1};

	var legend_recharge = '<p style="text-align: left; font-weight: bold;">Recharge(mm/yr)</p><p style="text-align: left; font-size:10px">0 20 100 500 <p style="text-align: left; margin-top: -15px; margin-left:72px; font-weight: bold;">Aquifer</p></p><i style="background: #e6ecff; fillOpacity: .7; color:#e6ecff; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #99b3ff; fillOpacity: .7; color:#99b3ff; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7; "></i><i style="background: #4d79ff; fillOpacity: .7; color:#4d79ff; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #0033cc; fillOpacity: .7; color:#0033cc; margin-right: 0px;  width: 60px; weight: 1; opacity: 0.7; "></i><p style="text-align: left; font-size:11px">Sand/Gravel</p><i style="background: #ecf9ec; fillOpacity: .7; color:#ecf9ec; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #b3e6b3; fillOpacity: .7; color:#b3e6b3; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7;"></i><i style="background: #66cc66; fillOpacity: .7; color:#66cc66; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #267326; fillOpacity: .7; color:#267326; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><p style="text-align: left;">Volcanic</p><i style="background: #ebebe0; fillOpacity: .7; color:#ebebe0; margin-right: 0px;   weight: 1; opacity: 0.7; width: 60px;  "></i><i style="background: #ccccb3; fillOpacity: .7; color:#ccccb3; width: 60px;   margin-right: 0px;   weight: 1; opacity: 0.7;"></i><i style="background: #a3a375; fillOpacity: .7; color:#a3a375; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><i style="background: #5c5c3d; fillOpacity: .7; color:#5c5c3d; margin-right: 0px;   width: 60px;   weight: 1; opacity: 0.7;"></i><p style="text-align: left;">Other</p>';
	var legend_irrigation = '<p style="text-align: left; font-weight:bold">Groundwater Irrigation Rights</p><br><p style="text-align: left;  style = "margin-top:20px;">Aquifer Type</p><img src="img/sandgravel.png" style="height:6px; width:6px; margin-top:11px; margin-left:1px;"><p style = "margin-top:5px;">Sand and Gravel</p><img src="img/igneous.png" style="height:6px; width:6px; margin-top:11px; margin-left:1px;"><p style = "margin-top:5px;">Igneous/Metamorphic</p><img src="img/other.png" style="height:6px; width:6px; margin-top:11px; margin-left:1px;"><p style = "margin-top:5px;">Other Rocks</p>';
	var legend_county ='<p style ="font-weight: bold;">2010 Total Groundwater Use in Mgal/day</p><i style="background: #f8000c; opacity: 0.8"></i><p>300+</p><i style="background: #ff6343; opacity: 0.8"></i><p>200 - 300</p><i style="background: #ffa458; opacity: 0.8"></i><p>100 - 200</p><i style="background: #ffd58d; opacity: 0.8"></i><p>25 - 100</p><i style="background: #feffcd; opacity: 0.8"></i><p>0 - 25</p>'

    var legend_crit = '<i style="background: #f8000c; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">GW Critical Area</b></p><i style="background: #ffa458; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">GW Limited Area</b></p>';
    var legend_manage = '<i style="background: #ffa458; fillOpacity: .8; weight: 1; opacity: 0.8; border:1px solid #fffff"></i><b><p style="text-align: left; margin-left: 25px">GW Management Area</b></p>';
		
//<p style="text-align:left; font-weight:bold">Hover for source</p>'

    var layers = {  	
            'counties': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:gw_counties&maxFeatures=10000&outputFormat=application%2Fjson',
            	{style:countyStyle, onEachFeature: function(feature, featureLayer) {
        			featureLayer.bindTooltip(feature.properties.INSTNAME + " : "+feature.properties.total+" Mgal/day", {className: 'label_tooltip'});
        			featureLayer.on({
        					mouseover: highlightCounty,
        					mouseout: resetCounty
        				})
    			}}
            	), legend_county],	
            'county_outlines': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:gw_counties&maxFeatures=10000&outputFormat=application%2Fjson',
            	{style:countyStyle2}
            	)],
            'conservation_critical': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:groundwater_conservation&maxFeatures=500&outputFormat=application%2Fjson',
            	{style:critStyle, onEachFeature: function(feature, featureLayer) {
            		if (feature.properties.Type != 'GWMA'){
        				featureLayer.bindTooltip(feature.properties.NAME, {className: 'label_tooltip'});
        				featureLayer.bindPopup(feature.properties.NAME, {className: 'label_tooltip'});
        				featureLayer.on({
        					add: highlightFeature,
        					mouseover: highlightCounty,
        					mouseout: resetCounty
        				})
        			}
        			
    			}}
            	), legend_crit],
            'groundwater_dissolved': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:groundwater_dissolved&maxFeatures=50&outputFormat=application%2Fjson',
            	{style:gwStyle, onEachFeature: function(feature, featureLayer) {
        				featureLayer.bindTooltip(feature.properties.rock_type + "<br>" + "Avg. Recharge Rate: " + feature.properties.rate + " mm/yr", {className: 'label_tooltip', sticky: true});
    					featureLayer.bindPopup(feature.properties.rock_type + "<br>" + "Avg. Recharge Rate: " + feature.properties.rate + " mm/yr", {className: 'label_tooltip', sticky: false});
    					featureLayer.on({
        					mouseover: highlightGroundwater,
        					mouseout: resetGroundwater
        				})
        				
    				}}
            	), legend_recharge],
            'sand_dissolved': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:groundwater_dissolved&maxFeatures=50&outputFormat=application%2Fjson',
            	{style:sandStyle, onEachFeature: function(feature, featureLayer) {        				
    				}}
            	), legend_recharge],
            'volcanic_dissolved': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:groundwater_dissolved&maxFeatures=50&outputFormat=application%2Fjson',
            	{style:volStyle, onEachFeature: function(feature, featureLayer) {		
    				}}
            	), legend_recharge],
            'other_dissolved': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:groundwater_dissolved&maxFeatures=50&outputFormat=application%2Fjson',
            	{style:otherStyle, onEachFeature: function(feature, featureLayer) {        				
    				}}
            	), legend_recharge],
        	'conservation_management': [L.geoJson.ajax('http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=baldricg_atlas:groundwater_conservation&maxFeatures=500&outputFormat=application%2Fjson',
            	{style:consStyle, onEachFeature: function(feature, featureLayer) {
            		if (feature.properties.Type == 'GWMA'){
        				featureLayer.bindTooltip(feature.properties.NAME, {className: 'label_tooltip'});
        				featureLayer.bindPopup(feature.properties.NAME, {className: 'label_tooltip'});
        				featureLayer.on({
        					add: highlightFeature,
        					mouseover: highlightCounty,
        					mouseout: resetCounty
        				})
        			}
        			
    			}}
            	), legend_manage],
            'groundwater_reprojected': [L.tileLayer.wms("http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/wms", {
        			layers: 'baldricg_atlas:groundwater_reprojected',
        			format: 'image/png',
        			minZoom: 6,
        			maxZoom: 15,
        			transparent: true,
    			})],
    		'irrigation': [L.tileLayer.wms("http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/wms", {
        			layers: 'baldricg_atlas:groundwater_irrigation',
        			format: 'image/png',
        			minZoom: 11,
        			maxZoom: 15,
        			transparent: true,
    			}), legend_irrigation],
    		'irrigation_points': [L.tileLayer.wms("http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/wms", {
        			layers: 'baldricg_atlas:groundwater_irrigation_points',
        			format: 'image/png',
        			minZoom: 6,
        			maxZoom: 10,
        			transparent: true,
    			})],
    		'elevation': [L.tileLayer.wms("http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_basemap/wms", {
        			layers: 'baldricg_basemap:or_relief',
        			format: 'image/png',
        			minZoom: 6,
        			maxZoom: 10,
        			transparent: true,
    			})],
    		'elevation2': [L.tileLayer.wms("http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_basemap/wms", {
        			layers: 'baldricg_basemap:or_relief',
        			format: 'image/png',
        			minZoom: 6,
        			maxZoom: 10,
        			opacity:0.1,
        			transparent: true,
    			})]

    		
    };

    var scenes = {
            overview: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Home', position:'fullpage'},
            recharge: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Aquifers', layers:['elevation','groundwater_dissolved']},
            recharge2: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Sand/Gravel', layers:['elevation2','sand_dissolved']},
            recharge3: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Volcanic', layers:['elevation2','volcanic_dissolved']},
            recharge4: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Other', layers:['elevation2','other_dissolved']},
            conservation_critical: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Conservation', layers:['conservation_critical']},
            conservation_management: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Management', layers:['conservation_management']},
            county_use: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'County Use', layers:['counties']},
            irrigation_aquifers: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'Irrigation', layers:['elevation2','irrigation_points','irrigation']},
            end: {lat: 44.1347254, lng:-122.7411479, zoom: 7, name:'End', position:'fullpage'}
    };
    
    

    $('.main').storymap({
        scenes: scenes,
        layers:layers,
        legend: false,
        scale:false,
        navbar: true,
        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
                var map = L.map('map',{zoomControl:false,  scrollWheelZoom:false}).setView([44.1347254, -122.7411479], 7);
            // add an basemap, which can be either OSM, mapbox, tilelayer, wmslayer or those designed by yourself.
           		/*L.tileLayer.wms("http://localhost:8080/geoserver/basemap/wms", {
        			layers: 'basemap:basemap_dark',
       				format: 'image/png',
       				minZoom: 6,
        			maxZoom: 15,
        			transparent: true,
        		attribution: "Created by Gareth Baldrica-Franklin"
    			}).addTo(map);
    			
    			L.tileLayer.wms("http://localhost:8080/geoserver/basemap/wms", {
        			layers: 'basemap:basemap_dark_labels',
        			format: 'image/png',
        			minZoom: 6,
        			maxZoom: 15,
        			transparent: true,
        			tiled: true, 
        			tilesorigin: [-180, 90]
    			}).addTo(map);
    			*/
    			
    			var CartoDB_DarkMatterNoLabels = L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png', {
					attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
					subdomains: 'abcd',
					maxZoom: 15,
					minZoom: 6,
				}).addTo(map);
				
				oregonCover = L.tileLayer.wms("http://mapious.ceoas.oregonstate.edu/geoserver/baldricg_atlas/wms", {
        			layers: 'baldricg_atlas:oregon_cover_white',
        			format: 'image/png',
        			minZoom: 6,
        			maxZoom: 15,
        			transparent: true,
    			}).addTo(map);
    			
    			oregonCover.setOpacity(0.1);
 				
 				var mini = new L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png', {
					attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
					subdomains: 'abcd',
					maxZoom: 8,
					minZoom: 5
				});
				
				var miniMap = new L.Control.MiniMap(mini, { toggleDisplay: false});
 				
				miniMap.addTo(map);
			
				new L.Control.Zoom({ position: 'bottomright'}).addTo(map);

				/*if (scene == 'portland'){
				miniMap;
				}*/
				map.setMaxBounds(map.getBounds());

            return map;
        }
    });
    
    document.getElementsByClassName("leaflet-control-attribution")[0].style.visibility = "hidden";

    
    $(document).on('click', '[data-toggle="lightbox"]', function(event) {
   		event.preventDefault();
    $(this).ekkoLightbox();
	});

</script>
</body>
</html>